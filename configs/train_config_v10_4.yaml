# DAWN v10.4 Training Config
# 실험: d=320, rank=256 (최고 rank)

# Data
data:
  base_dir: /content/drive/MyDrive/data
  train_files:
    - train/wikitext_5to1_texts.pkl
  val_files:
    - val/wikitext_5to1_texts.pkl

# Model Architecture
model:
  model_version: "10.0"
  d_model: 320
  n_layers: 4
  n_heads: 4
  rank: 256               # 128 → 256 (2배)

  # 뉴런 수 절반 (파라미터 동일 유지)
  n_compress: 12          # 24 → 12 (절반)
  n_expand: 3             # 6 → 3 (절반)

  # Top-K Selection
  compress_top_k: 4       # 12개 중 4개
  expand_top_k: 2         # 3개 중 2개
  router_noise: 0.1

  n_knowledge: 80
  knowledge_k: 10
  knowledge_rank: 64
  max_seq_len: 128
  dropout: 0.1

# Training
training:
  batch_size: 128
  num_epochs: 30
  lr: 0.0003
  weight_decay: 0.1
  warmup_epochs: 2
  orthogonality_weight: 0.01
  diversity_weight: 0.1
  load_balance_weight: 0.01
  process_norm_weight: 0.0

use_amp: true
checkpoint_dir: /content/drive/MyDrive/dawn/checkpoints_v10_4
log_dir: /content/drive/MyDrive/dawn/logs_v10_4

# =============================================================================
# Rank Ablation 비교 (d=320, 4L, 동일 파라미터 ~0.98M compress)
# =============================================================================
#
# | 항목              | v10.4 (this)      | v10.3             | v10.0             | v10.2              |
# |-------------------|-------------------|-------------------|-------------------|--------------------|
# | rank              | 256               | 128               | 64                | 32                 |
# | n_compress        | 12                | 24                | 48                | 96                 |
# | n_expand          | 3                 | 6                 | 12                | 24                 |
# | compress params   | 12×320×256=0.98M  | 24×320×128=0.98M  | 48×320×64=0.98M   | 96×320×32=0.98M    |
# | expand params     | 3×256×320=0.25M   | 6×128×320=0.25M   | 12×64×320=0.25M   | 24×32×320=0.25M    |
# | 표현력 (k×rank)   | 4×256=1024        | 6×128=768         | 8×64=512          | 12×32=384          |
# | 뉴런 수           | 최소 (12)         | 적음 (24)         | 중간 (48)         | 많음 (96)          |
#
# =============================================================================
