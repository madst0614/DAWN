# DAWN v10.3 Training Config
# 실험: d=320, rank=128 vs rank=64 vs rank=32 비교

# Data
data:
  base_dir: /content/drive/MyDrive/data
  train_files:
    - train/wikitext_5to1_texts.pkl
  val_files:
    - val/wikitext_5to1_texts.pkl

# Model Architecture
model:
  model_version: "10.0"
  d_model: 320
  n_layers: 4
  n_heads: 4
  rank: 128               # 64 → 128 (2배)

  # 뉴런 수 절반 (파라미터 동일 유지)
  n_compress: 24          # 48 → 24 (절반)
  n_expand: 6             # 12 → 6 (절반)

  # Top-K Selection
  compress_top_k: 6       # 비율 유지
  expand_top_k: 4
  router_noise: 0.1

  n_knowledge: 80
  knowledge_k: 10
  knowledge_rank: 64
  max_seq_len: 128
  dropout: 0.1

# Training
training:
  batch_size: 128
  num_epochs: 30
  lr: 0.0003
  weight_decay: 0.1
  warmup_epochs: 2
  orthogonality_weight: 0.01
  diversity_weight: 0.1
  load_balance_weight: 0.01
  process_norm_weight: 0.0

use_amp: true
checkpoint_dir: /content/drive/MyDrive/dawn/checkpoints_v10_3
log_dir: /content/drive/MyDrive/dawn/logs_v10_3

# =============================================================================
# Rank Ablation 비교 (d=320, 4L, 동일 파라미터 ~0.98M compress)
# =============================================================================
#
# | 항목              | v10.3 (this)      | v10.0 (baseline)  | v10.2              |
# |-------------------|-------------------|-------------------|--------------------|
# | rank              | 128               | 64                | 32                 |
# | n_compress        | 24                | 48                | 96                 |
# | n_expand          | 6                 | 12                | 24                 |
# | compress params   | 24×320×128=0.98M  | 48×320×64=0.98M   | 96×320×32=0.98M    |
# | expand params     | 6×128×320=0.25M   | 12×64×320=0.25M   | 24×32×320=0.25M    |
# | 표현력 (k×rank)   | 6×128=768         | 8×64=512          | 12×32=384          |
# | 뉴런 수           | 적음 (24)         | 중간 (48)         | 많음 (96)          |
#
# =============================================================================
